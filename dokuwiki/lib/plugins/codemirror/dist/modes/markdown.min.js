(function(a){if(typeof exports=="object"&&typeof module=="object")a(require("../../lib/codemirror"),require("../xml/xml"),require("../meta"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../xml/xml","../meta"],a);else a(CodeMirror)})(function(a){"use strict";a.defineMode("markdown",function(b,c){var d=a.getMode(b,"text/html");var e=d.name=="null";function f(c){if(a.findModeByName){var d=a.findModeByName(c);if(d)c=d.mime||d.mimes[0]}var e=a.getMode(b,c);return e.name=="null"?null:e}if(c.highlightFormatting===undefined)c.highlightFormatting=false;if(c.maxBlockquoteDepth===undefined)c.maxBlockquoteDepth=0;if(c.taskLists===undefined)c.taskLists=false;if(c.strikethrough===undefined)c.strikethrough=false;if(c.tokenTypeOverrides===undefined)c.tokenTypeOverrides={};var g={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"image",imageAltText:"image-alt-text",imageMarker:"image-marker",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var h in g){if(g.hasOwnProperty(h)&&c.tokenTypeOverrides[h]){g[h]=c.tokenTypeOverrides[h]}}var i=/^([*\-_])(?:\s*\1){2,}\s*$/,j=/^(?:[*\-+]|^[0-9]+([.)]))\s+/,k=/^\[(x| )\](?=\s)/,l=c.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,m=/^ *(?:\={1,}|-{1,})\s*$/,n=/^[^#!\[\]*_\\<>` "'(~]+/,o=new RegExp("^("+(c.fencedCodeBlocks===true?"~~~+|```+":c.fencedCodeBlocks)+")[ \\t]*([\\w+#-]*)"),p=/[!\"#$%&\'()*+,\-\.\/:;<=>?@\[\\\]^_`{|}~â€”]/;function q(a,b,c){b.f=b.inline=c;return c(a,b)}function r(a,b,c){b.f=b.block=c;return c(a,b)}function s(a){return!a||!/\S/.test(a.string)}function t(a){a.linkTitle=false;a.em=false;a.strong=false;a.strikethrough=false;a.quote=0;a.indentedCode=false;if(a.f==v){a.f=z;a.block=u}a.trailingSpace=0;a.trailingSpaceNewLine=false;a.prevLine=a.thisLine;a.thisLine=null;return null}function u(b,d){var e=b.sol();var h=d.list!==false,n=d.indentedCode;d.indentedCode=false;if(h){if(d.indentationDiff>=0){if(d.indentationDiff<4){d.indentation-=d.indentationDiff}d.list=null}else if(d.indentation>0){d.list=null}else{d.list=false}}var p=null;if(d.indentationDiff>=4){b.skipToEnd();if(n||s(d.prevLine)){d.indentation-=4;d.indentedCode=true;return g.code}else{return null}}else if(b.eatSpace()){return null}else if((p=b.match(l))&&p[1].length<=6){d.header=p[1].length;if(c.highlightFormatting)d.formatting="header";d.f=d.inline;return x(d)}else if(!s(d.prevLine)&&!d.quote&&!h&&!n&&(p=b.match(m))){d.header=p[0].charAt(0)=="="?1:2;if(c.highlightFormatting)d.formatting="header";d.f=d.inline;return x(d)}else if(b.eat(">")){d.quote=e?1:d.quote+1;if(c.highlightFormatting)d.formatting="quote";b.eatSpace();return x(d)}else if(b.peek()==="["){return q(b,d,E)}else if(b.match(i,true)){d.hr=true;return g.hr}else if(p=b.match(j)){var r=p[1]?"ol":"ul";d.indentation=b.column()+b.current().length;d.list=true;while(d.listStack&&b.column()<d.listStack[d.listStack.length-1]){d.listStack.pop()}d.listStack.push(d.indentation);if(c.taskLists&&b.match(k,false)){d.taskList=true}d.f=d.inline;if(c.highlightFormatting)d.formatting=["list","list-"+r];return x(d)}else if(c.fencedCodeBlocks&&(p=b.match(o,true))){d.fencedChars=p[1];d.localMode=f(p[2]);if(d.localMode)d.localState=a.startState(d.localMode);d.f=d.block=w;if(c.highlightFormatting)d.formatting="code-block";d.code=-1;return x(d)}return q(b,d,d.inline)}function v(b,c){var f=d.token(b,c.htmlState);if(!e){var g=a.innerMode(d,c.htmlState);if(g.mode.name=="xml"&&g.state.tagStart===null&&(!g.state.context&&g.state.tokenize.isInText)||c.md_inside&&b.current().indexOf(">")>-1){c.f=z;c.block=u;c.htmlState=null}}return f}function w(a,b){if(b.fencedChars&&a.match(b.fencedChars)){if(c.highlightFormatting)b.formatting="code-block";var d=x(b);b.localMode=b.localState=null;b.block=u;b.f=z;b.fencedChars=null;b.code=0;return d}else if(b.fencedChars&&a.skipTo(b.fencedChars)){return"comment"}else if(b.localMode){return b.localMode.token(a,b.localState)}else{a.skipToEnd();return g.code}}function x(a){var b=[];if(a.formatting){b.push(g.formatting);if(typeof a.formatting==="string")a.formatting=[a.formatting];for(var d=0;d<a.formatting.length;d++){b.push(g.formatting+"-"+a.formatting[d]);if(a.formatting[d]==="header"){b.push(g.formatting+"-"+a.formatting[d]+"-"+a.header)}if(a.formatting[d]==="quote"){if(!c.maxBlockquoteDepth||c.maxBlockquoteDepth>=a.quote){b.push(g.formatting+"-"+a.formatting[d]+"-"+a.quote)}else{b.push("error")}}}}if(a.taskOpen){b.push("meta");return b.length?b.join(" "):null}if(a.taskClosed){b.push("property");return b.length?b.join(" "):null}if(a.linkHref){b.push(g.linkHref,"url")}else{if(a.strong){b.push(g.strong)}if(a.em){b.push(g.em)}if(a.strikethrough){b.push(g.strikethrough)}if(a.linkText){b.push(g.linkText)}if(a.code){b.push(g.code)}if(a.image){b.push(g.image)}if(a.imageAltText){b.push(g.imageAltText,"link")}if(a.imageMarker){b.push(g.imageMarker)}}if(a.header){b.push(g.header,g.header+"-"+a.header)}if(a.quote){b.push(g.quote);if(!c.maxBlockquoteDepth||c.maxBlockquoteDepth>=a.quote){b.push(g.quote+"-"+a.quote)}else{b.push(g.quote+"-"+c.maxBlockquoteDepth)}}if(a.list!==false){var e=(a.listStack.length-1)%3;if(!e){b.push(g.list1)}else if(e===1){b.push(g.list2)}else{b.push(g.list3)}}if(a.trailingSpaceNewLine){b.push("trailing-space-new-line")}else if(a.trailingSpace){b.push("trailing-space-"+(a.trailingSpace%2?"a":"b"))}return b.length?b.join(" "):null}function y(a,b){if(a.match(n,true)){return x(b)}return undefined}function z(b,e){var f=e.text(b,e);if(typeof f!=="undefined")return f;if(e.list){e.list=null;return x(e)}if(e.taskList){var h=b.match(k,true)[1]!=="x";if(h)e.taskOpen=true;else e.taskClosed=true;if(c.highlightFormatting)e.formatting="task";e.taskList=false;return x(e)}e.taskOpen=false;e.taskClosed=false;if(e.header&&b.match(/^#+$/,true)){if(c.highlightFormatting)e.formatting="header";return x(e)}var i=b.next();if(e.linkTitle){e.linkTitle=false;var j=i;if(i==="("){j=")"}j=(j+"").replace(/([.?*+^\[\]\\(){}|-])/g,"\\$1");var l="^\\s*(?:[^"+j+"\\\\]+|\\\\\\\\|\\\\.)"+j;if(b.match(new RegExp(l),true)){return g.linkHref}}if(i==="`"){var m=e.formatting;if(c.highlightFormatting)e.formatting="code";b.eatWhile("`");var n=b.current().length;if(e.code==0){e.code=n;return x(e)}else if(n==e.code){var o=x(e);e.code=0;return o}else{e.formatting=m;return x(e)}}else if(e.code){return x(e)}if(i==="\\"){b.next();if(c.highlightFormatting){var q=x(e);var s=g.formatting+"-escape";return q?q+" "+s:s}}if(i==="!"&&b.match(/\[[^\]]*\] ?(?:\(|\[)/,false)){e.imageMarker=true;e.image=true;if(c.highlightFormatting)e.formatting="image";return x(e)}if(i==="["&&e.imageMarker&&b.match(/[^\]]*\](\(.*?\)| ?\[.*?\])/,false)){e.imageMarker=false;e.imageAltText=true;if(c.highlightFormatting)e.formatting="image";return x(e)}if(i==="]"&&e.imageAltText){if(c.highlightFormatting)e.formatting="image";var q=x(e);e.imageAltText=false;e.image=false;e.inline=e.f=B;return q}if(i==="["&&b.match(/[^\]]*\](\(.*\)| ?\[.*?\])/,false)&&!e.image){e.linkText=true;if(c.highlightFormatting)e.formatting="link";return x(e)}if(i==="]"&&e.linkText&&b.match(/\(.*?\)| ?\[.*?\]/,false)){if(c.highlightFormatting)e.formatting="link";var q=x(e);e.linkText=false;e.inline=e.f=B;return q}if(i==="<"&&b.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,false)){e.f=e.inline=A;if(c.highlightFormatting)e.formatting="link";var q=x(e);if(q){q+=" "}else{q=""}return q+g.linkInline}if(i==="<"&&b.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,false)){e.f=e.inline=A;if(c.highlightFormatting)e.formatting="link";var q=x(e);if(q){q+=" "}else{q=""}return q+g.linkEmail}if(i==="<"&&b.match(/^(!--|[a-z]+(?:\s+[a-z_:.\-]+(?:\s*=\s*[^ >]+)?)*\s*>)/i,false)){var t=b.string.indexOf(">",b.pos);if(t!=-1){var u=b.string.substring(b.start,t);if(/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(u))e.md_inside=true}b.backUp(1);e.htmlState=a.startState(d);return r(b,e,v)}if(i==="<"&&b.match(/^\/\w*?>/)){e.md_inside=false;return"tag"}else if(i==="*"||i==="_"){var w=1,y=b.pos==1?" ":b.string.charAt(b.pos-2);while(w<3&&b.eat(i))w++;var z=b.peek()||" ";var C=!/\s/.test(z)&&(!p.test(z)||/\s/.test(y)||p.test(y));var D=!/\s/.test(y)&&(!p.test(y)||/\s/.test(z)||p.test(z));var E=null,F=null;if(w%2){if(!e.em&&C&&(i==="*"||!D||p.test(y)))E=true;else if(e.em==i&&D&&(i==="*"||!C||p.test(z)))E=false}if(w>1){if(!e.strong&&C&&(i==="*"||!D||p.test(y)))F=true;else if(e.strong==i&&D&&(i==="*"||!C||p.test(z)))F=false}if(F!=null||E!=null){if(c.highlightFormatting)e.formatting=E==null?"strong":F==null?"em":"strong em";if(E===true)e.em=i;if(F===true)e.strong=i;var o=x(e);if(E===false)e.em=false;if(F===false)e.strong=false;return o}}else if(i===" "){if(b.eat("*")||b.eat("_")){if(b.peek()===" "){return x(e)}else{b.backUp(1)}}}if(c.strikethrough){if(i==="~"&&b.eatWhile(i)){if(e.strikethrough){if(c.highlightFormatting)e.formatting="strikethrough";var o=x(e);e.strikethrough=false;return o}else if(b.match(/^[^\s]/,false)){e.strikethrough=true;if(c.highlightFormatting)e.formatting="strikethrough";return x(e)}}else if(i===" "){if(b.match(/^~~/,true)){if(b.peek()===" "){return x(e)}else{b.backUp(2)}}}}if(i===" "){if(b.match(/ +$/,false)){e.trailingSpace++}else if(e.trailingSpace){e.trailingSpaceNewLine=true}}return x(e)}function A(a,b){var d=a.next();if(d===">"){b.f=b.inline=z;if(c.highlightFormatting)b.formatting="link";var e=x(b);if(e){e+=" "}else{e=""}return e+g.linkInline}a.match(/^[^>]+/,true);return g.linkInline}function B(a,b){if(a.eatSpace()){return null}var d=a.next();if(d==="("||d==="["){b.f=b.inline=D(d==="("?")":"]",0);if(c.highlightFormatting)b.formatting="link-string";b.linkHref=true;return x(b)}return"error"}var C={")":/^(?:[^\\\(\)]|\\.|\((?:[^\\\(\)]|\\.)*\))*?(?=\))/,"]":/^(?:[^\\\[\]]|\\.|\[(?:[^\\\[\\]]|\\.)*\])*?(?=\])/};function D(a){return function(b,d){var e=b.next();if(e===a){d.f=d.inline=z;if(c.highlightFormatting)d.formatting="link-string";var f=x(d);d.linkHref=false;return f}b.match(C[a]);d.linkHref=true;return x(d)}}function E(a,b){if(a.match(/^([^\]\\]|\\.)*\]:/,false)){b.f=F;a.next();if(c.highlightFormatting)b.formatting="link";b.linkText=true;return x(b)}return q(a,b,z)}function F(a,b){if(a.match(/^\]:/,true)){b.f=b.inline=G;if(c.highlightFormatting)b.formatting="link";var d=x(b);b.linkText=false;return d}a.match(/^([^\]\\]|\\.)+/,true);return g.linkText}function G(a,b){if(a.eatSpace()){return null}a.match(/^[^\s]+/,true);if(a.peek()===undefined){b.linkTitle=true}else{a.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,true)}b.f=b.inline=z;return g.linkHref+" url"}var H={startState:function(){return{f:u,prevLine:null,thisLine:null,block:u,htmlState:null,indentation:0,inline:z,text:y,formatting:false,linkText:false,linkHref:false,linkTitle:false,code:0,em:false,strong:false,header:0,hr:false,taskList:false,list:false,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:false,strikethrough:false,fencedChars:null}},copyState:function(b){return{f:b.f,prevLine:b.prevLine,thisLine:b.thisLine,block:b.block,htmlState:b.htmlState&&a.copyState(d,b.htmlState),indentation:b.indentation,localMode:b.localMode,localState:b.localMode?a.copyState(b.localMode,b.localState):null,inline:b.inline,text:b.text,formatting:false,linkTitle:b.linkTitle,code:b.code,em:b.em,strong:b.strong,strikethrough:b.strikethrough,header:b.header,hr:b.hr,taskList:b.taskList,list:b.list,listStack:b.listStack.slice(0),quote:b.quote,indentedCode:b.indentedCode,trailingSpace:b.trailingSpace,trailingSpaceNewLine:b.trailingSpaceNewLine,md_inside:b.md_inside,fencedChars:b.fencedChars}},token:function(a,b){b.formatting=false;if(a!=b.thisLine){var c=b.header||b.hr;b.header=0;b.hr=false;if(a.match(/^\s*$/,true)||c){t(b);if(!c)return null;b.prevLine=null}b.prevLine=b.thisLine;b.thisLine=a;b.taskList=false;b.trailingSpace=0;b.trailingSpaceNewLine=false;b.f=b.block;var d=a.match(/^\s*/,true)[0].replace(/\t/g,"    ").length;b.indentationDiff=Math.min(d-b.indentation,4);b.indentation=b.indentation+b.indentationDiff;if(d>0)return null}return b.f(a,b)},innerMode:function(a){if(a.block==v)return{state:a.htmlState,mode:d};if(a.localState)return{state:a.localState,mode:a.localMode};return{state:a,mode:H}},blankLine:t,getType:x,closeBrackets:"()[]{}''\"\"``",fold:"markdown"};return H},"xml");a.defineMIME("text/x-markdown","markdown")});
//# sourceMappingURL=markdown.min.js.map